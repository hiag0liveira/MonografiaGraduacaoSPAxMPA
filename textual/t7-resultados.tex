\chapter{Resultados e Discussões}
\label{cap:resultados}

Este capítulo apresenta os achados empíricos do estudo, com foco na experiência do usuário medida por \textit{Core Web Vitals} (coleta em campo, no cliente) e, de forma complementar, em diagnósticos laboratoriais do Lighthouse. Como contexto operacional, reporta-se também o consumo de CPU, memória e PIDs dos contêineres durante as execuções. A metodologia, o ambiente controlado e os procedimentos de coleta já foram descritos no Cap.~\ref{cap:estudo_caso_dev}; aqui concentramos a atenção em resultados e implicações.

\section{Resultados}
Os testes cobriram as duas variantes da WallTech (\acrshort{ssr}/\acrshort{mpa} em Next.js e \acrshort{csr}/\acrshort{spa} em React) nas páginas: inicial, resultados de busca e detalhes da notícia. Para cada cenário, foram realizados 10--15 carregamentos após \textit{warm-up}, e as leituras são analisadas por mediana (p50) e, quando pertinente, p95.

\subsection{Fontes de dados}
\begin{itemize}
    \item \textbf{Web Vitals (núcleo)}: \acrshort{ttfb}, \acrshort{fcp}, \acrshort{lcp}, \acrshort{cls}, \acrshort{inp} registrados no cliente e persistidos em NDJSON.
    \item \textbf{Lighthouse (apoio)}: TBT e principais oportunidades/auditorias de desempenho, além de verificações de Acessibilidade e SEO.
    \item \textbf{Recursos do servidor}: CPU/memória/PIDs via \texttt{docker stats}, como contexto de custo de execução.
\end{itemize}

\subsection{Análise e Visualização dos Dados}
Os dados coletados, incluindo as métricas de \textit{Web Vitals} e as medições de recursos do servidor, foram exportados e analisados com o auxílio do Power BI. A ferramenta foi utilizada para gerar gráficos e visualizações interativas que facilitam a interpretação dos resultados e a comparação entre os diferentes cenários (\acrshort{ssr} e \acrshort{csr}). O uso do Power BI permitiu a criação de dashboards dinâmicos que ilustram claramente as tendências das métricas ao longo das execuções e facilitam a análise de variações nas diferentes páginas testadas.

\subsection{Tratamento dos Dados}
Os dados do Web Vitals foram coletados no formato NDJSON (Newline Delimited JSON) e importados como arquivos de texto no Power BI. Cada linha do arquivo correspondia a um objeto JSON individual representando uma métrica registrada no navegador.

Para estruturar essas informações, foi utilizada a funcionalidade de transformação de dados do Power BI. Cada linha foi analisada como um objeto JSON, e, em seguida, esses objetos foram expandidos em colunas, convertendo os campos internos de cada métrica em atributos tabulares.

Essa expansão resultou nas seguintes colunas principais:

\begin{itemize}
    \item \textbf{id}: identificador da interação registrada.
    \item \textbf{name}: nome da métrica (por exemplo, \texttt{INP}, \texttt{CLS}, \texttt{LCP}).
    \item \textbf{value}: valor numérico observado para a métrica.
    \item \textbf{rating}: classificação qualitativa (\textit{good}, \textit{needs improvement}, \textit{poor}).
    \item \textbf{navigationType}: tipo de navegação associada à métrica (ex: reload, back/forward).
    \item \textbf{attribution}: detalhes adicionais sobre o elemento ou evento associado à métrica.
    \item \textbf{entries}: informações brutas sobre a entrada original da medição.
    \item \textbf{ts}: timestamp da coleta.
\end{itemize}

Com os dados estruturados dessa forma, foi possível aplicar filtros, agregações e análises comparativas entre SSR e CSR, utilizando os recursos visuais e analíticos do Power BI de maneira eficiente.

\subsection{Metas de referência}
Adotaram-se os seguintes alvos para interpretação:
\begin{itemize}
    \item \textbf{LCP} $\leq 2{,}5$\,s;\quad \textbf{CLS} $\leq 0{,}10$;\quad \textbf{INP} $\leq 200$\,ms;\quad \textbf{TTFB} $\leq 800$\,ms.
    \item \textbf{TBT (Lighthouse)} $<200$\,ms;\quad \textbf{Acessibilidade (LH)} $\geq 90$;\quad \textbf{SEO (LH)} $\geq 90$.
\end{itemize}

\subsection{Resultados para SSR}
\label{subsec:resultados-ssr}

\subsubsection{Recursos do servidor}
Ao longo dos cenários, o contêiner \textit{Next.js} manteve \textbf{CPU} baixa e estável (aprox.\ 8--13\%), sem picos relevantes; a queda ao final da série coincide com o término do experimento (\autoref{fig:ssr-cpu}). A \textbf{memória} permaneceu em patamar quase constante, com variação estreita e redução apenas no encerramento das execuções (\autoref{fig:ssr-mem}). Esse comportamento é compatível com o processamento por requisição do SSR e não sinaliza saturação.

\begin{figure}[H]
    \centering
    \caption{Média de uso de CPU por tempo (\acrshort{ssr})}
    \includegraphics[width=0.9\textwidth]{media/uso_cpu_ssr.jpeg}
    \legend{Fonte: os autores.}
    \label{fig:ssr-cpu}
\end{figure}

\begin{figure}[H]
    \centering
    \caption{Média de uso de memória por tempo (\acrshort{ssr})}
    \includegraphics[width=0.9\textwidth]{media/uso_memoria_ssr.jpeg}
    \legend{Fonte: os autores.}
    \label{fig:ssr-mem}
\end{figure}

\subsubsection{Web Vitals (cliente)}
Conforme a \autoref{fig:ssr-webvitals}, as leituras de campo foram, em sua maioria, classificadas como \textit{good}. Os poucos casos de \textit{needs-improvement} concentraram-se em \acrshort{lcp} e \acrshort{inp}, e houve uma fração reduzida de \acrshort{fcp} em \textit{poor} efeito compatível com custos de \textit{hydration} e com elementos visuais de grande porte na dobra (imagens \emph{hero}). Em relação às metas adotadas, os resultados situam-se, em geral, próximos ou dentro dos limiares de referência: \acrshort{lcp} $\leq 2{,}5$\,s; \acrshort{cls} $\leq 0{,}10$; \acrshort{inp} $\leq 200$\,ms; \acrshort{ttfb} $\leq 800$\,ms.

\begin{figure}[H]
    \centering
    \caption{Classificação das métricas de desempenho (\acrshort{ssr}) com Web Vitals}
    \includegraphics[width=0.9\textwidth]{media/metricas_ssr_web_vitals.jpeg}
    \legend{Fonte: os autores.}
    \label{fig:ssr-webvitals}
\end{figure}

\subsubsection{Lighthouse (apoio diagnóstico)}
Para explicar variações residuais e priorizar melhorias, auditamos as rotas \emph{home}, \emph{busca} e \emph{detalhe} no modo \emph{Navigation} do Chrome DevTools, considerando três indicadores: TBT, Acessibilidade e SEO.
A Tabela~\ref{tab:lh-ssr} consolida as medianas observadas nos relatórios HTML anexados (\texttt{ssrMobile.html}, \texttt{ssrMobileBusca.html}, \texttt{ssrtestePage.html}).

\begin{table}[H]
\centering
\caption{Lighthouse (SSR) — mediana por rota}
\label{tab:lh-ssr}
\begin{tabular}{|l|c|c|c|}
\hline
\textbf{Rota} & \textbf{TBT (ms)} & \textbf{Acessibilidade (\%)} & \textbf{SEO (\%)} \\
\hline
Home    & 12 & 95  & 100 \\
Busca   & 10 & 99  & 100 \\
Detalhe & 0--7\footnotemark[1] & 100 & 100 \\
\hline
\end{tabular}
\end{table}
\footnotetext[1]{Variações muito baixas entre execuções; mediana $\approx$ 5\,ms.}

\noindent \textit{Leitura.}
(i) \textbf{TBT} muito abaixo da meta interna ($<200$\,ms) em todas as rotas, corroborando \acrshort{inp} em \textit{good};
(ii) \textbf{Acessibilidade} alta (95--100\%), com ajustes residuais (hierarquia de headings, foco visível, rótulos) de fácil endereçamento;
(iii) \textbf{SEO} consistente (100\%), indicando sinalização adequada (título, \emph{meta description}, \texttt{canonical}, \texttt{robots}, \texttt{viewport}) aspecto particularmente relevante no fluxo SSR.

\subsection{Síntese (SSR)}
Servidor com CPU/RAM contidos; \emph{Web Vitals} majoritariamente \textit{good}, com atenção pontual a \acrshort{lcp}/\acrshort{fcp} em páginas com imagens destacadas e pós-hidratação; \emph{Lighthouse} confirma TBT reduzido e altos escores de Acessibilidade e SEO, sustentando o SSR para páginas públicas sensíveis à descoberta.

\subsection{Resultados para CSR}
\label{subsec:resultados-csr}

\subsubsection{Recursos do servidor}
O contêiner da \emph{SPA} apresentou \textbf{CPU} muito baixa e estável, com oscilações discretas e picos inferiores a 5\% (\autoref{fig:csr-cpu}). A \textbf{memória} permaneceu praticamente constante e em patamar reduzido durante todo o ensaio, coerente com a entrega estática e a execução da lógica no cliente (\autoref{fig:csr-mem}). Não se observaram sinais de saturação.

\begin{figure}[H]
\centering
\caption{Média de uso de CPU por tempo (\acrshort{csr})}
\includegraphics[width=0.9\textwidth]{media/uso_cpu_csr.jpeg}
\legend{Fonte: os autores.}
\label{fig:csr-cpu}
\end{figure}

\begin{figure}[H]
\centering
\caption{Média de uso de memória por tempo (\acrshort{csr})}
\includegraphics[width=0.9\textwidth]{media/uso_memoria_csr.jpeg}
\legend{Fonte: os autores.}
\label{fig:csr-mem}
\end{figure}

\subsubsection{Web Vitals (cliente)}
As leituras de campo indicam predomínio de \textit{good} em \acrshort{ttfb}, \acrshort{fcp}, \acrshort{lcp} e \acrshort{inp} (\autoref{fig:csr-webvitals}). O ponto fora da curva é a \textbf{\acrshort{cls}}, com concentrações em \textit{poor}. O padrão é típico de SPAs quando ocorrem \emph{layout shifts} durante a hidratação ou quando imagens/slots não reservam espaço antes do carregamento (dimensões ausentes, fontes sem \emph{preload}, inserções acima da dobra). Em relação às metas, as leituras ficaram, em geral, dentro ou próximas dos limiares de referência (\acrshort{lcp} $\leq 2{,}5$\,s; \acrshort{cls} $\leq 0{,}10$; \acrshort{inp} $\leq 200$\,ms; \acrshort{ttfb} $\leq 800$\,ms), com a ressalva da \acrshort{cls}.

\begin{figure}[H]
\centering
\caption{Classificação das métricas de desempenho (\acrshort{csr}) com Web Vitals}
\includegraphics[width=0.9\textwidth]{media/metricas_csr_web_vitals.jpeg}
\legend{Fonte: os autores.}
\label{fig:csr-webvitals}
\end{figure}

\subsubsection{Lighthouse (apoio diagnóstico)}
Para explicar oscilações residuais e orientar priorizações, auditamos as rotas críticas no \emph{Chrome DevTools} (modo \emph{Navigation}), com três indicadores: TBT, Acessibilidade e SEO.

\noindent \textit{Achados.}
\begin{itemize}
    \item \textbf{TBT}: manteve-se em patamar \textbf{muito baixo} (dezenas de milissegundos) nas páginas inspecionadas, consistente com \acrshort{inp} \textit{good}.
    \item \textbf{Acessibilidade}: escores altos na \emph{home} (93--94\,\%), com ajustes residuais (hierarquia de \emph{headings}, foco visível, rótulos/\textit{alt}) valores observados nos relatórios “Home (Web)” e “Home (Mobile)”.
    \item \textbf{SEO}: a \emph{home} registrou \textasciitilde{}83\,\% (Web e Mobile), sugerindo oportunidades pontuais (por exemplo, \emph{meta description}/\texttt{canonical}/\texttt{robots}/\texttt{hreflang}, quando aplicável).
\end{itemize}

\noindent \textit{Leitura.} Em conjunto, os relatórios apontam que o gargalo do CSR não está em bloqueio de \emph{main thread} (TBT baixo), mas em estabilidade visual e em alguns sinais de SEO. Na prática, os seguintes ajustes tendem a capturar os ganhos: (i) reservar dimensões de imagens e \emph{cards} acima da dobra (\texttt{width}/\texttt{height} ou \texttt{aspect-ratio}); (ii) \emph{preload} de fontes e imagens \emph{hero} (com \texttt{font-display: swap}); (iii) evitar inserções DOM acima da dobra durante a hidratação; (iv) completar metadados de SEO (título/descrição/\texttt{canonical}/\texttt{robots}) e revisar indexabilidade.

\subsubsection{Síntese (CSR)}
Servidor praticamente ocioso (CPU e RAM baixos); \emph{Web Vitals} em boa forma para \acrshort{ttfb}/\acrshort{fcp}/\acrshort{lcp}/\acrshort{inp}, com atenção especial à \acrshort{cls}. O \emph{Lighthouse} confirmou TBT reduzido, Acessibilidade alta e SEO com melhorias de rápida implementação, coerentes com o perfil de SPA e suas responsabilidades no cliente.

\subsection{Comparação entre SSR e CSR}
\label{subsec:comparacao-ssr-csr}

Esta seção compara, de forma integrada, experiência do usuário (\emph{Web Vitals} em campo), diagnóstico laboratorial (Lighthouse: TBT, Acessibilidade e SEO) e custo operacional (CPU/Memória nos contêineres). A análise revela que a escolha arquitetônica representa um trade-off fundamental sobre onde a carga computacional deve residir: no servidor ou no cliente. A leitura está ancorada nas medianas (p50) e, quando pertinente, no p95 dos cenários home, busca e detalhe.

\begin{table}[H]
\centering
\caption{Síntese comparativa dos resultados (SSR $\times$ CSR) neste estudo}
\label{tab:comparativo-ssr-csr}
\begin{tabular}{|p{4.2cm}|p{5.2cm}|p{5.2cm}|}
\hline
\textbf{Aspecto} & \textbf{SSR (MPA/Next.js)} & \textbf{CSR (SPA/React)} \\
\hline
\textbf{CPU no servidor} & Baixa e estável (\textit{$\sim$8--13\%}), sem picos relevantes. & Muito baixa; oscilações discretas com picos $<5\%$. \\
\hline
\textbf{Memória no servidor} & Estável, variação estreita; queda apenas ao término dos testes. & Muito baixa e praticamente constante. \\
\hline
\textbf{Web Vitals (campo)} & Predominância de \textit{good}; pequenos trechos \textit{needs-improvement} em \textbf{LCP}/\textbf{INP} e fração \textit{poor} em \textbf{FCP} (páginas com imagens \emph{hero} e pós-hidratação). & \textbf{TTFB}/\textbf{FCP}/\textbf{LCP}/\textbf{INP} majoritariamente \textit{good}; \textbf{CLS} com ocorrências \textit{poor} (shifts na montagem/hidratação e elementos sem reserva de espaço). \\
\hline
\textbf{Lighthouse: TBT} & \textbf{Muito baixo} (home $\approx$12\,ms; busca $\approx$10\,ms; detalhe $\approx$5\,ms). & \textbf{Muito baixo} (ordem de dezenas de ms na home). \\
\hline
\textbf{Lighthouse: Acessibilidade} & \textbf{Alta} (95--100\%). & \textbf{Alta} (93--94\% na home). \\
\hline
\textbf{Lighthouse: SEO} & \textbf{100\%} nas rotas auditadas. & \textbf{$\sim$83\%} na home; indica metadados/sinalizações a completar. \\
\hline
\textbf{Leitura operacional} & Parte da renderização no servidor melhora \textbf{TTFB}/\emph{first paint} e favorece \textbf{SEO}; cuidado com \emph{hydration} e imagens de grande porte. & Renderização no cliente alivia o servidor e mantém \textbf{TBT/INP} baixos; requer disciplina de layout para evitar \textbf{CLS} e ajustes de \textbf{SEO}. \\
\hline
\end{tabular}
\end{table}

\subsubsection{Pontos fortes do SSR.}
(i) Tempo até primeira resposta/primeiro conteúdo. O HTML pré-renderizado acelera a exibição inicial, refletindo-se em \textit{TTFB}/\textit{FCP} consistentes e TBT residual. Essa agilidade é um fator psicológico poderoso, transmitindo eficiência e sendo crucial para reter a atenção do usuário nos primeiros segundos.
(ii) Descoberta e rastreabilidade. SEO com 100\% nas rotas testadas, reforçando a adequação do SSR para páginas públicas e conteúdo editorial.
(iii)Estabilidade Visual. O índice de \acrshort{cls} praticamente nulo garantiu que a experiência não fosse interrompida por mudanças de layout abruptas.
(iv) Previsibilidade de performance. Em cenários com rede/CPU do cliente mais limitados, a renderização no servidor reduz o risco de longas tarefas no \emph{main thread} do navegador.

\subsubsection{Pontos fracos do SSR.}
(i) \textbf{Custo de hidratação e navegação.} Após o HTML inicial, a ativação dos componentes pode degradar \textbf{LCP}/\textbf{FCP} em páginas com muito JS. A navegação subsequente, ao exigir uma nova requisição completa ao servidor, pode quebrar a sensação de fluidez contínua.
(ii) \textbf{Custo no servidor (ainda que baixo).} O processamento por requisição eleva discretamente \textbf{CPU}/\textbf{memória} no host, implicando maiores custos de infraestrutura e complexidade de escalonamento.
(iii) \textbf{Complexidade de build/deploy.} Estratégias como \emph{streaming} e \emph{Server Components} elevam a complexidade de arquitetura.

\subsubsection{Pontos fortes do CSR.}
(i) \textbf{Interatividade contínua.} Após o carregamento inicial, a navegação entre seções ocorre de forma quase instantânea, com \textbf{TBT/INP} muito baixos, emulando a agilidade de um aplicativo nativo.
(ii) \textbf{Custo operacional.} CPU/memória do servidor permanecem muito baixos, já que o servidor atua majoritariamente como um provedor de arquivos estáticos, resultando em custos operacionais menores.
(iii) \textbf{Escalabilidade horizontal simples.} Conteúdo estático facilita o uso de cache e CDNs, reduzindo a pressão sobre o backend.

\subsubsection{Pontos fracos do CSR.} 
(i) \textbf{Estabilidade visual.} O CLS apresentou ocorrências \textit{poor}. O processo de hidratação e a renderização dinâmica podem causar mudanças de layout que frustram o usuário e comprometem a usabilidade.
(ii) \textbf{Sinais de SEO.} Escores de \textasciitilde83\% no Lighthouse indicam a necessidade de completar metadados e sinalizações essenciais para a indexabilidade.
(iii) \textbf{Dependência de JS no cliente.} O tempo de carregamento inicial (LCP) é mais lento, pois depende do download e execução do \textit{bundle} JavaScript. Em dispositivos modestos, isso pode comprometer a performance se o \textit{bundle} não for estritamente otimizado.

\subsubsection{Observação sobre a Ausência do FID em CSR.}
No \acrshort{csr}, o \acrfull{fid} não é capturado da maneira tradicional, pois a página precisa ser 'hidratada' pelo JavaScript antes de se tornar completamente interativa. Esse processo de hidratação impede que o \acrshort{fid} meça corretamente a primeira interação do usuário, tornando-o menos relevante em ambientes \acrshort{csr}. Por isso, o \acrfull{inp} é utilizado como métrica alternativa, já que ele captura o tempo de resposta entre a interação do usuário e a atualização visual da página, oferecendo uma avaliação mais precisa da interatividade contínua, o que é especialmente importante em páginas altamente dinâmicas como as renderizadas no cliente.

\subsection{Discussão}
\label{subsec:discussao-comparativa}
Os resultados alinham-se e fornecem validação empírica para as recomendações consolidadas na literatura, confirmando que não existe uma solução universalmente superior. A escolha é uma decisão estratégica que transcende a tecnologia.

\textbf{(i) Recursos do servidor.} O \acrshort{ssr} consumiu levemente mais CPU/memória (ainda baixos), resultado do processamento por requisição. O \acrshort{csr}, por outro lado, opera como \emph{static hosting}, com custo mínimo no host, transferindo a carga computacional para o dispositivo do usuário.

\textbf{(ii) Experiência do usuário.} Em \acrshort{ssr}, a entrega inicial é perceptivelmente rápida e os escores de SEO e Acessibilidade são superiores. Em \acrshort{csr}, a interatividade após o carregamento é o grande trunfo, mas o principal cuidado é a CLS, que pode degradar a experiência.

\textbf{(iii) Coerência entre campo e laboratório.} Os \textit{Web Vitals} em campo e o TBT do Lighthouse convergiram, indicando baixo bloqueio de \emph{main thread} em ambos os modelos. As divergências em CLS (CSR) e SEO(CSR $<$ SSR) são áreas classicamente sensíveis à estratégia de renderização.

\subsection{Implicações práticas}
A decisão entre as arquiteturas deve ser ponderada à luz dos objetivos do produto, das expectativas do usuário e das capacidades da equipe de desenvolvimento.
\begin{itemize}
    \item \textbf{Priorizar SSR} para aplicações de conteúdo, como portais de notícias, plataformas de e-commerce e blogs, onde a otimização para mecanismos de busca (SEO) é vital, e a velocidade da primeira impressão (TTFB e FCP) é um fator determinante para o sucesso do negócio.
    \item \textbf{Priorizar CSR} para aplicações web ricas e complexas, como dashboards analíticos, sistemas de gestão interna (ERPs) e plataformas de software como serviço (SaaS), que geralmente são acessadas após autenticação e onde a fluidez da interatividade contínua (INP) é mais valorizada do que a indexabilidade de páginas individuais.
\end{itemize}

\subsection{Ajustes recomendados}
\textbf{SSR (mitigar LCP/INP).} Otimizar e dimensionar imagens (usar \texttt{priority} para \emph{hero} e \emph{lazy} abaixo da dobra), considerar \emph{streaming}/\emph{partial hydration}/\emph{Server Components}, reduzir JS não crítico e declarar \texttt{preload}/\texttt{dns-prefetch} para recursos essenciais. \\
\textbf{CSR (mitigar CLS e elevar SEO).} Reservar dimensões de mídia (\texttt{width}/\texttt{height} ou \texttt{aspect-ratio}); evitar inserções acima da dobra durante a hidratação; \texttt{font-display: swap} com \emph{preload} de fontes e imagens \emph{hero}; placeholders do tamanho final; completar metadados e sinalizações (\emph{title}/\emph{description}/\texttt{canonical}/\texttt{robots}/\texttt{hreflang} quando aplicável).

\subsection{Síntese}
No cenário testado, \textbf{SSR} e \textbf{CSR} entregaram boa experiência de uso com baixa pressão de recursos. O SSR destacou-se por SEO e exibição inicial mais previsível, sendo ideal para aplicações de conteúdo. O CSR reduziu o custo no servidor e garantiu interatividade fluida, com a contrapartida de maior propensão a CLS e desafios de SEO, mostrando-se adequado para aplicações ricas e logadas. A decisão final deve considerar o perfil de tráfego, a exigência de descoberta e o tipo de interação, aplicando as otimizações para mitigar os pontos fracos identificados em cada abordagem.